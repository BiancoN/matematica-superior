<!DOCTYPE html>
<html class="principal">
<head>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <meta charset="UTF-8">
    <title>Aproximacion hiperbólica tipo 2</title>
</head>
<body>

<h1 class="titulo-principal">Aproximacion hiperbólica tipo 2</h1>
<p class="inicio"><a href="index.html">Volver al inicio</a></p>

<br/>

<script>window.$ = window.jQuery = require('jquery');</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

<form class="formulario">


    <div class="table-responsive">
        <table id="tablaValores" class="table" style=" width: 98%; margin-left: 1%;">
            <tr><th>X</th><th>Y</th></tr>
            <tr><td> <input style="width: 100%; border: 0px;" class="x" type="number"></td>
                <td><input style="width: 100%; border: 0px;" type="number" class="y"></td></tr>
        </table>
    </div>


    <br>

    <div class="row-fluid">
        <button type="button" id="Agregar" class="btn btn-primary" style="margin-bottom: 25px; margin-left: 1%; position: inherit; float: left;">Agregar valor</button>
        <div class="form-group">
            <input type="number" placeholder="Cantidad de decimales" class="form-control" id="usr" style="margin-bottom: 25px; margin-right: 60%; width: 23%;float: right; position: inherit;">
        </div>
    </div>

    <br>

    <button type="button" id="Generar" class="btn btn-warning" style=" margin-left: 1%; margin-bottom: 25px;">Generar Tabla</button>

    <br>

    <table id="tablaResultados">

    </table>

    <br>

    <div id="resultado"></div>


    <br/>

    <div id="myDiv" ></div>





</form>


<script>
    // You can also require other files to run in this process
    //require('./renderer.js')

    require('./jquery-3.2.1.min')

    $( document ).ready(function() {
        $("#masCampos").click(function() {
            $("#tabla").append("<tr><td><input type=\"number\" id=\"valorx\" class=\"casillero\"></td>" +
                "<td><input type=\"number\" id=\"valory\" class=\"casillero\"></td></tr>");
        });

    });


    var valores = [];
    $("#Agregar").click(function(){
        $("#tablaValores").append("<tr><td> <input rype=\"number\" style=\"width: 100%; border: 0px;\" class=\"x\"></td>" +
            "<td><input rype=\"number\" style=\"width: 100%; border: 0px;\"class=\"y\"></td></tr>");
    });

    $("#Generar").click(function(){
        valores = [];
        $("#tablaResultados").html("<tr><th></th><th>X</th><th>1/Y</th><th>X^2</th><th>X/y</th></tr>");
        $('#tablaValores tr').each(function() {
            x=parseFloat($(this).find(".x").val());
            y=parseFloat($(this).find(".y").val());
            if($.isNumeric(x)
              && $.isNumeric(y)
              && y != 0){
                valores.push([x,1/y,x*x,x/y]);
            }
        });
        //array.push(values);

        n=valores.length;
        sumx=0;sumy=0;sumxx=0;sumxy=0;
        for(i=0;i<valores.length;i++){
            sumx += valores[i][0];
            sumy += valores[i][1];
            sumxx += valores[i][2];
            sumxy += valores[i][3];
            $("#tablaResultados").append("<tr><td></td><td>"+valores[i][0]+"</td>"+"<td>"+valores[i][1]+"</td>"+"<td>"+valores[i][2]+"</td>"+"<td>"+valores[i][3]+"</td></tr>");

        }

        $("#tablaResultados").append("<tr><td>Σ</td><td>"+sumx+"</td>"+"<td>"+sumy+"</td>"+"<td>"+sumxx+"</td>"+"<td>"+sumxy+"</td></tr>");


        m = ((sumxy - (sumx*sumy)/n)/(sumxx-(sumx*sumx)/n)).toFixed(5);
        b = (sumy/n - m*(sumx/n)).toFixed(5);

        a = 1/m
        b2 = b*a

        $("#resultado").html("Funcion aproximada: Y = ("+a+")/(X +"+" ("+b2+"))");




        datax=[];
        datay=[];
        labelsValues=[0];


        function arrayMax(array) {
            return array.reduce(function(a, b) {
                return Math.max(a, b);
            });
        }



        function arrayMin(array) {
            return array.reduce(function(a, b) {
                return Math.min(a, b);
            });
        }

        dataset2=[];
        console.log(n);

        for(i=0;i<n;i++){
            dataset2[i]={x:valores[i][0],y:valores[i][1]};
            datax[i] = valores[i][0];
            datay[i] = 1/valores[i][1];
        }
        console.log(dataset2);
        minimo = arrayMin(datax);
        maximo = arrayMax(datax);



        for(i=0;i<10;i++){
            labelsValues[i]=minimo+i*((maximo-minimo));
        }


        dataset1=[];

        for(i=0; i<=n; i++){
            if ((parseFloat(b2) + datax[i]) != 0)
            dataset1[i]= parseFloat(a) / (parseFloat(b2) + datax[i]);;
        }




        var funcion = {
            x: datax,
            y: dataset1,
            type: 'scatter',
            name: 'Aproximacion funcion'
        };

        // Valores de la tabla
        var puntos = {
            x: datax,
            y: datay,
            mode: 'markers',
            name: 'Puntos tabla'
        };

        var data = [funcion, puntos];

        Plotly.newPlot('myDiv', data);


    });







</script>

<link rel="stylesheet" type="text/css" href="estilos.css">
<link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
</body>
</html>
